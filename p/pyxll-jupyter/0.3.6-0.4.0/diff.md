# Comparing `tmp/pyxll_jupyter-0.3.6-py3-none-any.whl.zip` & `tmp/pyxll_jupyter-0.4.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,23 +1,24 @@
-Zip file size: 34141 bytes, number of entries: 21
+Zip file size: 43390 bytes, number of entries: 22
 -rw-rw-rw-  2.0 fat      496 b- defN 20-Sep-14 16:14 pyxll_jupyter/__init__.py
--rw-rw-rw-  2.0 fat    22987 b- defN 23-Apr-25 14:52 pyxll_jupyter/kernel.py
+-rw-rw-rw-  2.0 fat    23073 b- defN 23-May-15 15:16 pyxll_jupyter/kernel.py
 -rw-rw-rw-  2.0 fat     9105 b- defN 23-Jan-26 10:15 pyxll_jupyter/magic.py
--rw-rw-rw-  2.0 fat    10122 b- defN 22-Jan-12 15:35 pyxll_jupyter/pyxll.py
+-rw-rw-rw-  2.0 fat    30183 b- defN 23-May-15 15:18 pyxll_jupyter/onedrive.py
+-rw-rw-rw-  2.0 fat    11056 b- defN 23-May-15 15:17 pyxll_jupyter/pyxll.py
 -rw-rw-rw-  2.0 fat       50 b- defN 23-Jan-26 10:15 pyxll_jupyter/kernel_managers/__init__.py
--rw-rw-rw-  2.0 fat     4196 b- defN 23-Jan-26 10:15 pyxll_jupyter/kernel_managers/extipy.py
+-rw-rw-rw-  2.0 fat     4196 b- defN 23-May-15 14:48 pyxll_jupyter/kernel_managers/extipy.py
 -rw-rw-rw-  2.0 fat       43 b- defN 23-Jan-26 10:15 pyxll_jupyter/provisioning/__init__.py
 -rw-rw-rw-  2.0 fat     1816 b- defN 23-Apr-25 14:52 pyxll_jupyter/provisioning/existing.py
 -rw-rw-rw-  2.0 fat     5704 b- defN 21-Jul-27 09:57 pyxll_jupyter/resources/browser.png
 -rw-rw-rw-  2.0 fat     4436 b- defN 20-Sep-14 08:15 pyxll_jupyter/resources/jupyter.png
 -rw-rw-rw-  2.0 fat     1658 b- defN 21-Jul-27 09:57 pyxll_jupyter/resources/ribbon.xml
 -rw-rw-rw-  2.0 fat       64 b- defN 21-Jul-27 09:57 pyxll_jupyter/widgets/__init__.py
 -rw-rw-rw-  2.0 fat     4786 b- defN 21-Jul-27 09:57 pyxll_jupyter/widgets/browser.py
 -rw-rw-rw-  2.0 fat     1856 b- defN 22-Jan-12 15:35 pyxll_jupyter/widgets/jupyter.py
 -rw-rw-rw-  2.0 fat     3302 b- defN 22-Jan-12 15:35 pyxll_jupyter/widgets/qtimports.py
--rw-rw-rw-  2.0 fat     1087 b- defN 23-Apr-25 14:56 pyxll_jupyter-0.3.6.dist-info/LICENSE.md
--rw-rw-rw-  2.0 fat     5415 b- defN 23-Apr-25 14:56 pyxll_jupyter-0.3.6.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 23-Apr-25 14:56 pyxll_jupyter-0.3.6.dist-info/WHEEL
--rw-rw-rw-  2.0 fat      187 b- defN 23-Apr-25 14:56 pyxll_jupyter-0.3.6.dist-info/entry_points.txt
--rw-rw-rw-  2.0 fat       14 b- defN 23-Apr-25 14:56 pyxll_jupyter-0.3.6.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     1854 b- defN 23-Apr-25 14:56 pyxll_jupyter-0.3.6.dist-info/RECORD
-21 files, 79270 bytes uncompressed, 31081 bytes compressed:  60.8%
+-rw-rw-rw-  2.0 fat     1087 b- defN 23-May-15 15:23 pyxll_jupyter-0.4.0.dist-info/LICENSE.md
+-rw-rw-rw-  2.0 fat     5415 b- defN 23-May-15 15:23 pyxll_jupyter-0.4.0.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 23-May-15 15:23 pyxll_jupyter-0.4.0.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat      187 b- defN 23-May-15 15:23 pyxll_jupyter-0.4.0.dist-info/entry_points.txt
+-rw-rw-rw-  2.0 fat       14 b- defN 23-May-15 15:23 pyxll_jupyter-0.4.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     1937 b- defN 23-May-15 15:23 pyxll_jupyter-0.4.0.dist-info/RECORD
+22 files, 110556 bytes uncompressed, 40204 bytes compressed:  63.6%
```

## zipnote {}

```diff
@@ -3,14 +3,17 @@
 
 Filename: pyxll_jupyter/kernel.py
 Comment: 
 
 Filename: pyxll_jupyter/magic.py
 Comment: 
 
+Filename: pyxll_jupyter/onedrive.py
+Comment: 
+
 Filename: pyxll_jupyter/pyxll.py
 Comment: 
 
 Filename: pyxll_jupyter/kernel_managers/__init__.py
 Comment: 
 
 Filename: pyxll_jupyter/kernel_managers/extipy.py
@@ -39,26 +42,26 @@
 
 Filename: pyxll_jupyter/widgets/jupyter.py
 Comment: 
 
 Filename: pyxll_jupyter/widgets/qtimports.py
 Comment: 
 
-Filename: pyxll_jupyter-0.3.6.dist-info/LICENSE.md
+Filename: pyxll_jupyter-0.4.0.dist-info/LICENSE.md
 Comment: 
 
-Filename: pyxll_jupyter-0.3.6.dist-info/METADATA
+Filename: pyxll_jupyter-0.4.0.dist-info/METADATA
 Comment: 
 
-Filename: pyxll_jupyter-0.3.6.dist-info/WHEEL
+Filename: pyxll_jupyter-0.4.0.dist-info/WHEEL
 Comment: 
 
-Filename: pyxll_jupyter-0.3.6.dist-info/entry_points.txt
+Filename: pyxll_jupyter-0.4.0.dist-info/entry_points.txt
 Comment: 
 
-Filename: pyxll_jupyter-0.3.6.dist-info/top_level.txt
+Filename: pyxll_jupyter-0.4.0.dist-info/top_level.txt
 Comment: 
 
-Filename: pyxll_jupyter-0.3.6.dist-info/RECORD
+Filename: pyxll_jupyter-0.4.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## pyxll_jupyter/kernel.py

```diff
@@ -424,14 +424,17 @@
     exe = cmd[0]
     if "." in exe and exe.rsplit(".", 1)[-1].lower() == "exe":
         shell = False
         popen_kwargs["executable"] = exe
         si.dwFlags |= subprocess.STARTF_USESHOWWINDOW | 1
         cmd = [os.path.basename(exe)] + cmd[1:]
 
+    if initial_path:
+        _log.debug(f"Starting Jupyter in '{initial_path}'.")
+
     proc = subprocess.Popen(cmd,
                             cwd=initial_path,
                             env=env,
                             shell=shell,
                             stdout=subprocess.PIPE,
                             stderr=subprocess.STDOUT,
                             startupinfo=si,
```

## pyxll_jupyter/pyxll.py

```diff
@@ -7,14 +7,15 @@
 To install this package use::
 
     pip install pyxll_jupyter
 
 """
 from .widgets import JupyterQtWidget, QApplication, QMessageBox
 from .kernel import launch_jupyter
+from .onedrive import get_onedrive_path
 from pyxll import xlcAlert, get_config, xl_app, xl_macro, schedule_call
 from functools import partial
 import ctypes.wintypes
 import pkg_resources
 import logging
 import sys
 import os
@@ -39,23 +40,42 @@
             use_workbook_dir = bool(int(cfg.get("JUPYTER", "use_workbook_dir")))
         except (ValueError, TypeError):
             _log.error("Unexpected value for JUPYTER.use_workbook_dir.")
 
     if use_workbook_dir:
         xl = xl_app(com_package="win32com")
         wb = xl.ActiveWorkbook
-        if wb is not None and wb.FullName and os.path.exists(wb.FullName):
-            return os.path.dirname(wb.FullName)
+        if wb is not None and wb.FullName:
+            path = wb.FullName
+
+            # If the workbook path exists then use it
+            if os.path.exists(path):
+                return os.path.dirname(path)
+
+            # Otherwise see if it's a OneDrive link and try to resolve it
+            lpath = path.lower()
+            if lpath.startswith("https://"):
+                try:
+                    onedrive_path = get_onedrive_path(path)
+                    if onedrive_path:
+                        if os.path.exists(onedrive_path):
+                            return os.path.dirname(onedrive_path)
+                        _log.warning(f"OneDrive path '{onedrive_path}' does not exist")
+                except Exception as e:
+                    _log.warn(f"Unable to get local OneDrive path from URL '{path}'", exc_info=True)
+
+            # If we can't use this path then log a warning
+            _log.warning(f"Workbook path '{path}' not found and cannot be used as the Jupyter folder.")
 
     # Otherwise use the path option
     if cfg.has_option("JUPYTER", "notebook_dir"):
         path = cfg.get("JUPYTER", "notebook_dir").strip("\"\' ")
         if os.path.exists(path):
             return os.path.normpath(path)
-        _log.warning("Notebook path '%s' does not exist" % path)
+        _log.warning(f"Notebook path '{path}' does not exist")
 
     # And if that's not set use My Documents
     CSIDL_PERSONAL = 5  # My Documents
     SHGFP_TYPE_CURRENT = 0  # Get current, not default value
 
     buf = ctypes.create_unicode_buffer(ctypes.wintypes.MAX_PATH)
     ctypes.windll.shell32.SHGetFolderPathW(None, CSIDL_PERSONAL, None, SHGFP_TYPE_CURRENT, buf)
```

## Comparing `pyxll_jupyter-0.3.6.dist-info/LICENSE.md` & `pyxll_jupyter-0.4.0.dist-info/LICENSE.md`

 * *Files identical despite different names*

## Comparing `pyxll_jupyter-0.3.6.dist-info/METADATA` & `pyxll_jupyter-0.4.0.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pyxll-jupyter
-Version: 0.3.6
+Version: 0.4.0
 Summary: Adds Jupyter notebooks to Microsoft Excel using PyXLL.
 Project-URL: Source, https://github.com/pyxll/pyxll-jupyter
 Project-URL: Tracker, https://github.com/pyxll/pyxll-jupyter/issues
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: Microsoft :: Windows
 Description-Content-Type: text/markdown
```

## Comparing `pyxll_jupyter-0.3.6.dist-info/RECORD` & `pyxll_jupyter-0.4.0.dist-info/RECORD`

 * *Files 24% similar despite different names*

```diff
@@ -1,21 +1,22 @@
 pyxll_jupyter/__init__.py,sha256=mdO9kpbRcBx_UPSU8Zyk6vWvvZnWk-Eand3_Q7ns8RI,496
-pyxll_jupyter/kernel.py,sha256=MCB_NZKBbw_r1wEVpf2Z87OV8A5N-RAt6PtW722EJng,22987
+pyxll_jupyter/kernel.py,sha256=QkZpm7OIhKSdXAwQzqlVU1JUOcC4oFYYtQvjEYoo9oU,23073
 pyxll_jupyter/magic.py,sha256=KMd_yLfBT6fT-A0EgHGdKJs54hwDmomy6_cQDkmguKo,9105
-pyxll_jupyter/pyxll.py,sha256=gG8BF4LU68BkJKVPLta77GkJms6TAdB7oVYM1oZspng,10122
+pyxll_jupyter/onedrive.py,sha256=L1vxM9fGlnvbDypmBvis8-fqy40bc1lSFX5tYPfUMn0,30183
+pyxll_jupyter/pyxll.py,sha256=rOG_udjC94Fy7XOixklGtrUx-b6Zr9pbncvyq-B2jTo,11056
 pyxll_jupyter/kernel_managers/__init__.py,sha256=BGLY9OvRJSMCQwhpiz7NVG6DL2XeJIE1agExSBFVrH0,50
 pyxll_jupyter/kernel_managers/extipy.py,sha256=brHXOVCDKFgTfAHORXljrPdPkY9YLMJpKJ4BsM4rlCg,4196
 pyxll_jupyter/provisioning/__init__.py,sha256=SSQgCsR_Jfjwk3FgHRRbIicdnXb2NBXY5q9eya5f_JU,43
 pyxll_jupyter/provisioning/existing.py,sha256=N4ZFoxeyg0zdglNwnDm9KlU1GQ2YxH-cIiSqy_YzHsM,1816
 pyxll_jupyter/resources/browser.png,sha256=fFQoWhmOzguG-mzOSfQw1aBgu54zM7RcUrO8dC1qD60,5704
 pyxll_jupyter/resources/jupyter.png,sha256=H6BglrUs-6rd-Y4kOZxelx4G3cg0yDKbRZNtTQf4KV0,4436
 pyxll_jupyter/resources/ribbon.xml,sha256=w5jIm_Z77Gb7K_NXPMrV1YixcvYEvZIUvt0EPp0zaV8,1658
 pyxll_jupyter/widgets/__init__.py,sha256=1eX2naiOVjgOqQ8UxsKYX1_c_IRAGK7FU-YBSjdGzWs,64
 pyxll_jupyter/widgets/browser.py,sha256=yUiiAl_G2TuZi_bz9Eovt7ViK6Z2NMsHYzvHsakqd-Q,4786
 pyxll_jupyter/widgets/jupyter.py,sha256=cRI2_sWYZBUN5zLtOwj3ozHz934pSrtVTv5Y1GwwphY,1856
 pyxll_jupyter/widgets/qtimports.py,sha256=gHzHDEC-48Q2VIEdD-_PUFws9lNQatESTpjQAqpJNxo,3302
-pyxll_jupyter-0.3.6.dist-info/LICENSE.md,sha256=_Lv_zhFvdAlSe69UkLShEwwRh7pdMDdjzRZcnxMRj2I,1087
-pyxll_jupyter-0.3.6.dist-info/METADATA,sha256=HflsFpXvp3ILONe4U7kRKPyBbVgFnfOfLdlqYWPMjsg,5415
-pyxll_jupyter-0.3.6.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-pyxll_jupyter-0.3.6.dist-info/entry_points.txt,sha256=i_TC66oleWSd3gOkTNbNHU6oIqzvfszSGhiU8UNcI9U,187
-pyxll_jupyter-0.3.6.dist-info/top_level.txt,sha256=O8yEET2io_Bn_UyxBhokmuBOysbyrxVg2jGa1OVWQ8M,14
-pyxll_jupyter-0.3.6.dist-info/RECORD,,
+pyxll_jupyter-0.4.0.dist-info/LICENSE.md,sha256=_Lv_zhFvdAlSe69UkLShEwwRh7pdMDdjzRZcnxMRj2I,1087
+pyxll_jupyter-0.4.0.dist-info/METADATA,sha256=oy99BwFjinB2WI-X4JVdmJ9-BCOgAdUU0RnegtVtOVs,5415
+pyxll_jupyter-0.4.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+pyxll_jupyter-0.4.0.dist-info/entry_points.txt,sha256=i_TC66oleWSd3gOkTNbNHU6oIqzvfszSGhiU8UNcI9U,187
+pyxll_jupyter-0.4.0.dist-info/top_level.txt,sha256=O8yEET2io_Bn_UyxBhokmuBOysbyrxVg2jGa1OVWQ8M,14
+pyxll_jupyter-0.4.0.dist-info/RECORD,,
```

