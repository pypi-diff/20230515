# Comparing `tmp/odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3-py3-none-any.whl.zip` & `tmp/odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,24 +1,25 @@
-Zip file size: 23736 bytes, number of entries: 22
--rw-r--r--  2.0 unx     4426 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/README.rst
--rw-r--r--  2.0 unx      202 b- defN 22-Dec-06 04:37 odoo/addons/mis_builder_total_committed_purchase/__init__.py
--rw-r--r--  2.0 unx      820 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/__manifest__.py
--rw-r--r--  2.0 unx     4810 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase.sql
--rw-r--r--  2.0 unx      861 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase_tag_rel.sql
--rw-r--r--  2.0 unx     3221 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/i18n/mis_builder_total_committed_purchase.pot
--rw-r--r--  2.0 unx       43 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/models/__init__.py
--rw-r--r--  2.0 unx     1990 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/models/mis_total_committed_purchase.py
--rw-r--r--  2.0 unx      138 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx      752 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      377 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/readme/HISTORY.rst
--rw-r--r--  2.0 unx      237 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/readme/ROADMAP.rst
--rw-r--r--  2.0 unx       86 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/readme/USAGE.rst
--rw-r--r--  2.0 unx        0 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/readme/newsfragments/.gitignore
--rw-r--r--  2.0 unx      649 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/security/mis_total_committed_purchase.xml
--rw-r--r--  2.0 unx     4770 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/static/description/icon.png
--rw-r--r--  2.0 unx    14863 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/static/description/index.html
--rw-r--r--  2.0 unx     1116 b- defN 22-Dec-06 04:38 odoo/addons/mis_builder_total_committed_purchase/views/mis_total_committed_purchase.xml
--rw-r--r--  2.0 unx     5128 b- defN 22-Dec-06 04:38 odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-Dec-06 04:38 odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 22-Dec-06 04:38 odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2861 b- defN 22-Dec-06 04:38 odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/RECORD
-22 files, 47447 bytes uncompressed, 18682 bytes compressed:  60.6%
+Zip file size: 24505 bytes, number of entries: 23
+-rw-r--r--  2.0 unx     4611 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/README.rst
+-rw-r--r--  2.0 unx      202 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/__init__.py
+-rw-r--r--  2.0 unx      833 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/__manifest__.py
+-rw-r--r--  2.0 unx     5601 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase.sql
+-rw-r--r--  2.0 unx      844 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase_analytic_account_rel.sql
+-rw-r--r--  2.0 unx     3007 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/i18n/mis_builder_total_committed_purchase.pot
+-rw-r--r--  2.0 unx       43 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/models/__init__.py
+-rw-r--r--  2.0 unx     1240 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/models/mis_total_committed_purchase.py
+-rw-r--r--  2.0 unx      206 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx       87 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/readme/CREDITS.rst
+-rw-r--r--  2.0 unx      752 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      377 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/readme/HISTORY.rst
+-rw-r--r--  2.0 unx      237 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/readme/ROADMAP.rst
+-rw-r--r--  2.0 unx       86 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/readme/USAGE.rst
+-rw-r--r--  2.0 unx        0 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/readme/newsfragments/.gitignore
+-rw-r--r--  2.0 unx      649 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/security/mis_total_committed_purchase.xml
+-rw-r--r--  2.0 unx     4770 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/static/description/icon.png
+-rw-r--r--  2.0 unx    15434 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/static/description/index.html
+-rw-r--r--  2.0 unx      928 b- defN 23-May-15 13:29 odoo/addons/mis_builder_total_committed_purchase/views/mis_total_committed_purchase.xml
+-rw-r--r--  2.0 unx     5314 b- defN 23-May-15 13:29 odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-15 13:29 odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-May-15 13:29 odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2995 b- defN 23-May-15 13:29 odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/RECORD
+23 files, 48313 bytes uncompressed, 19215 bytes compressed:  60.2%
```

## zipnote {}

```diff
@@ -6,29 +6,32 @@
 
 Filename: odoo/addons/mis_builder_total_committed_purchase/__manifest__.py
 Comment: 
 
 Filename: odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase.sql
 Comment: 
 
-Filename: odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase_tag_rel.sql
+Filename: odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase_analytic_account_rel.sql
 Comment: 
 
 Filename: odoo/addons/mis_builder_total_committed_purchase/i18n/mis_builder_total_committed_purchase.pot
 Comment: 
 
 Filename: odoo/addons/mis_builder_total_committed_purchase/models/__init__.py
 Comment: 
 
 Filename: odoo/addons/mis_builder_total_committed_purchase/models/mis_total_committed_purchase.py
 Comment: 
 
 Filename: odoo/addons/mis_builder_total_committed_purchase/readme/CONTRIBUTORS.rst
 Comment: 
 
+Filename: odoo/addons/mis_builder_total_committed_purchase/readme/CREDITS.rst
+Comment: 
+
 Filename: odoo/addons/mis_builder_total_committed_purchase/readme/DESCRIPTION.rst
 Comment: 
 
 Filename: odoo/addons/mis_builder_total_committed_purchase/readme/HISTORY.rst
 Comment: 
 
 Filename: odoo/addons/mis_builder_total_committed_purchase/readme/ROADMAP.rst
@@ -48,20 +51,20 @@
 
 Filename: odoo/addons/mis_builder_total_committed_purchase/static/description/index.html
 Comment: 
 
 Filename: odoo/addons/mis_builder_total_committed_purchase/views/mis_total_committed_purchase.xml
 Comment: 
 
-Filename: odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/METADATA
+Filename: odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/METADATA
 Comment: 
 
-Filename: odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/WHEEL
+Filename: odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/WHEEL
 Comment: 
 
-Filename: odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/top_level.txt
+Filename: odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/RECORD
+Filename: odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/mis_builder_total_committed_purchase/README.rst

```diff
@@ -10,21 +10,21 @@
 .. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
     :target: https://odoo-community.org/page/development-status
     :alt: Beta
 .. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
     :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
     :alt: License: AGPL-3
 .. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fmis--builder--contrib-lightgray.png?logo=github
-    :target: https://github.com/OCA/mis-builder-contrib/tree/15.0/mis_builder_total_committed_purchase
+    :target: https://github.com/OCA/mis-builder-contrib/tree/16.0/mis_builder_total_committed_purchase
     :alt: OCA/mis-builder-contrib
 .. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
-    :target: https://translation.odoo-community.org/projects/mis-builder-contrib-15-0/mis-builder-contrib-15-0-mis_builder_total_committed_purchase
+    :target: https://translation.odoo-community.org/projects/mis-builder-contrib-16-0/mis-builder-contrib-16-0-mis_builder_total_committed_purchase
     :alt: Translate me on Weblate
 .. |badge5| image:: https://img.shields.io/badge/runbot-Try%20me-875A7B.png
-    :target: https://runbot.odoo-community.org/runbot/277/15.0
+    :target: https://runbot.odoo-community.org/runbot/277/16.0
     :alt: Try me on Runbot
 
 |badge1| |badge2| |badge3| |badge4| |badge5| 
 
 Addon to create a alternative source based on all purchase order lines with MIS Builder : all the purchase orders that are not in draft or cancelled state are taken into account.
 
 The account_id of the committed purchase bases itself on the product's account_id if set
@@ -78,15 +78,15 @@
 
 Bug Tracker
 ===========
 
 Bugs are tracked on `GitHub Issues <https://github.com/OCA/mis-builder-contrib/issues>`_.
 In case of trouble, please check there if your issue has already been reported.
 If you spotted it first, help us smashing it by providing a detailed and welcomed
-`feedback <https://github.com/OCA/mis-builder-contrib/issues/new?body=module:%20mis_builder_total_committed_purchase%0Aversion:%2015.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.
+`feedback <https://github.com/OCA/mis-builder-contrib/issues/new?body=module:%20mis_builder_total_committed_purchase%0Aversion:%2016.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.
 
 Do not contact contributors directly about support or help with technical issues.
 
 Credits
 =======
 
 Authors
@@ -97,24 +97,31 @@
 
 Contributors
 ~~~~~~~~~~~~
 
 * Stéphane Bidoul <stephane.bidoul@acsone.eu>
 * Arnaud Pineux <arnaud.pineux@acsone.eu>
 * Camille Morand <camille.morand@camptocamp.com>
+* `Trobz <https://trobz.com>`_:
+    * Dzung Tran <dungtd@trobz.com>
+
+Other credits
+~~~~~~~~~~~~~
+
+The migration of this module from 15.0 to 16.0 was financially supported by Camptocamp
 
 Maintainers
 ~~~~~~~~~~~
 
 This module is maintained by the OCA.
 
 .. image:: https://odoo-community.org/logo.png
    :alt: Odoo Community Association
    :target: https://odoo-community.org
 
 OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.
 
-This module is part of the `OCA/mis-builder-contrib <https://github.com/OCA/mis-builder-contrib/tree/15.0/mis_builder_total_committed_purchase>`_ project on GitHub.
+This module is part of the `OCA/mis-builder-contrib <https://github.com/OCA/mis-builder-contrib/tree/16.0/mis_builder_total_committed_purchase>`_ project on GitHub.
 
 You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
```

## odoo/addons/mis_builder_total_committed_purchase/__manifest__.py

```diff
@@ -2,20 +2,20 @@
 # Copyright 2022 Camptocamp SA (https://www.camptocamp.com)
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
 
 {
     "name": "MIS Builder Total Committed Purchase",
     "summary": """Addon to create a alternative source based on all purchase order line with
     MIS Builder.""",
-    "version": "15.0.1.0.1",
+    "version": "16.0.1.0.0",
     "license": "AGPL-3",
     "author": "ACSONE SA/NV, Camptocamp, Odoo Community Association (OCA)",
     "website": "https://github.com/OCA/mis-builder-contrib",
     "depends": ["mis_builder", "purchase"],
     "data": [
         "data/mis_total_committed_purchase.sql",
-        "data/mis_total_committed_purchase_tag_rel.sql",
+        "data/mis_total_committed_purchase_analytic_account_rel.sql",
         "security/mis_total_committed_purchase.xml",
         "views/mis_total_committed_purchase.xml",
     ],
     "installable": True,
 }
```

## odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase.sql

```diff
@@ -10,45 +10,65 @@
               WHERE r2.name > r.name AND
                     r2.currency_id = r.currency_id AND
                     (r2.company_id is null or r2.company_id = c.id)
                ORDER BY r2.name ASC
                LIMIT 1) AS date_end
             FROM res_currency_rate r
               JOIN res_company c ON (r.company_id is null or r.company_id = c.id)
+        ),
+        pol_analytic AS (
+            SELECT
+                id,
+                jsonb_object_keys(analytic_distribution)::INTEGER AS analytic_account_id,
+                (analytic_distribution -> jsonb_object_keys(analytic_distribution))::NUMERIC AS analytic_amount
+            FROM purchase_order_line
         )
 
         /* ALL CONFIRMED PURCHASES */
     SELECT
         pol.company_id AS company_id,
         pol.name AS name,
         po.date_planned::date as date,
-        pol.account_analytic_id as analytic_account_id,
         pol.product_id as product_id,
         pol.order_id as purchase_order_id,
         pol.id AS res_id,
         'purchase.order.line' AS res_model,
         CASE
           WHEN (cast(split_part(ip.value_reference, ',', 2) AS INTEGER) IS NOT NULL) THEN cast(split_part(ip.value_reference, ',', 2) AS INTEGER)
           WHEN (cast(split_part(ipc1.value_reference, ',', 2) AS INTEGER) IS NOT NULL) THEN cast(split_part(ipc1.value_reference, ',', 2) AS INTEGER)
           WHEN (cast(split_part(ipc2.value_reference, ',', 2) AS INTEGER) IS NOT NULL) THEN cast(split_part(ipc2.value_reference, ',', 2) AS INTEGER)
           WHEN (cast(split_part(ipc3.value_reference, ',', 2) AS INTEGER) IS NOT NULL) THEN cast(split_part(ipc3.value_reference, ',', 2) AS INTEGER)
           WHEN (cast(split_part(ipc4.value_reference, ',', 2) AS INTEGER) IS NOT NULL) THEN cast(split_part(ipc4.value_reference, ',', 2) AS INTEGER)
           WHEN (cast(split_part(ipc5.value_reference, ',', 2) AS INTEGER) IS NOT NULL) THEN cast(split_part(ipc5.value_reference, ',', 2) AS INTEGER)
           WHEN (cast(split_part(ipd.value_reference, ',', 2) AS INTEGER) IS NOT NULL) THEN cast(split_part(ipd.value_reference, ',', 2) AS INTEGER)
           ELSE cast(NULL AS INTEGER)
         END AS account_id,
+
         CASE
-          WHEN (pol.price_unit / COALESCE(cur.rate, 1.0) * pol.product_qty)::decimal(16,2) >= 0.0 THEN (pol.price_unit / COALESCE(cur.rate, 1.0) * pol.product_qty)::decimal(16,2)
-          ELSE 0.0
+            WHEN
+                aaa.id = pol_analytic.analytic_account_id
+                AND (pol.price_unit / COALESCE(cur.rate, 1.0) * pol.product_qty)::decimal(16,2) >= 0.0
+            THEN (pol.price_unit / COALESCE(cur.rate, 1.0) * pol.product_qty)::decimal(16,2)
+                * COALESCE(pol_analytic.analytic_amount, 100.0) / 100.0
+            ELSE 0.0
         END AS debit,
+
         CASE
-          WHEN (pol.price_unit / COALESCE(cur.rate, 1.0) * pol.product_qty)::decimal(16,2)  < 0 THEN (pol.price_unit / COALESCE(cur.rate, 1.0) * pol.product_qty)::decimal(16,2)
-          ELSE 0.0
-        END AS credit
+            WHEN
+                aaa.id = pol_analytic.analytic_account_id
+                AND (pol.price_unit / COALESCE(cur.rate, 1.0) * pol.product_qty)::decimal(16,2)  < 0
+            THEN (pol.price_unit / COALESCE(cur.rate, 1.0) * pol.product_qty)::decimal(16,2)
+                * COALESCE(pol_analytic.analytic_amount, 100.0) / 100.0
+        ELSE 0.0
+        END AS credit,
+        pol_analytic.analytic_account_id
+
         FROM purchase_order_line pol
+            LEFT JOIN pol_analytic ON pol.id = pol_analytic.id
+            LEFT JOIN account_analytic_account aaa ON pol_analytic.analytic_account_id = aaa.id
             LEFT JOIN purchase_order po on po.id = pol.order_id
             LEFT JOIN product_product pp ON pp.id = pol.product_id
             LEFT JOIN product_template pt ON pt.id = pp.product_tmpl_id
             LEFT JOIN product_category pc1 ON pc1.id = pt.categ_id
             LEFT JOIN product_category pc2 ON pc2.id = pc1.parent_id
             LEFT JOIN product_category pc3 ON pc3.id = pc2.parent_id
             LEFT JOIN product_category pc4 ON pc4.id = pc3.parent_id
```

## odoo/addons/mis_builder_total_committed_purchase/i18n/mis_builder_total_committed_purchase.pot

```diff
@@ -1,14 +1,14 @@
 # Translation of Odoo Server.
 # This file contains the translation of the following modules:
 # 	* mis_builder_total_committed_purchase
 #
 msgid ""
 msgstr ""
-"Project-Id-Version: Odoo Server 15.0\n"
+"Project-Id-Version: Odoo Server 16.0\n"
 "Report-Msgid-Bugs-To: \n"
 "Last-Translator: \n"
 "Language-Team: \n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: \n"
 "Plural-Forms: \n"
@@ -20,19 +20,14 @@
 
 #. module: mis_builder_total_committed_purchase
 #: model:ir.model.fields,field_description:mis_builder_total_committed_purchase.field_mis_total_committed_purchase__analytic_account_id
 msgid "Analytic Account"
 msgstr ""
 
 #. module: mis_builder_total_committed_purchase
-#: model:ir.model.fields,field_description:mis_builder_total_committed_purchase.field_mis_total_committed_purchase__analytic_tag_ids
-msgid "Analytic Tags"
-msgstr ""
-
-#. module: mis_builder_total_committed_purchase
 #: model:ir.model.fields,field_description:mis_builder_total_committed_purchase.field_mis_total_committed_purchase__company_id
 msgid "Company"
 msgstr ""
 
 #. module: mis_builder_total_committed_purchase
 #: model:ir.model.fields,field_description:mis_builder_total_committed_purchase.field_mis_total_committed_purchase__credit
 msgid "Credit"
```

## odoo/addons/mis_builder_total_committed_purchase/models/mis_total_committed_purchase.py

```diff
@@ -9,50 +9,28 @@
 class MisTotalCommittedPurchase(models.Model):
 
     _name = "mis.total.committed.purchase"
     _description = "MIS Total Purchase Commitment"
     _auto = False
 
     name = fields.Char()
-    analytic_account_id = fields.Many2one(
-        comodel_name="account.analytic.account", string="Analytic Account"
-    )
     account_id = fields.Many2one(comodel_name="account.account")
     company_id = fields.Many2one(comodel_name="res.company")
+    analytic_account_id = fields.Many2one(
+        "account.analytic.account", "Analytic Account"
+    )
     product_id = fields.Many2one(comodel_name="product.product")
     purchase_order_id = fields.Many2one(comodel_name="purchase.order")
     credit = fields.Float()
     debit = fields.Float()
     date = fields.Date()
 
-    analytic_tag_ids = fields.Many2many(
-        comodel_name="account.analytic.tag",
-        relation="mis_total_committed_purchase_tag_rel",
-        column1="mis_total_committed_purchase_id",
-        column2="account_analytic_tag_id",
-        string="Analytic Tags",
-    )
-
     def init(self):
-
         with open(
             get_module_resource(
                 "mis_builder_total_committed_purchase",
                 "data",
                 "mis_total_committed_purchase.sql",
             )
         ) as f:
             tools.drop_view_if_exists(self.env.cr, "mis_total_committed_purchase")
             self.env.cr.execute(f.read())
-
-        with open(
-            get_module_resource(
-                "mis_builder_total_committed_purchase",
-                "data",
-                "mis_total_committed_purchase_tag_rel.sql",
-            )
-        ) as f2:
-            # Create many2many relation for account.analytic.tag
-            tools.drop_view_if_exists(
-                self.env.cr, "mis_total_committed_purchase_tag_rel"
-            )
-            self.env.cr.execute(f2.read())
```

## odoo/addons/mis_builder_total_committed_purchase/readme/CONTRIBUTORS.rst

```diff
@@ -1,3 +1,5 @@
 * Stéphane Bidoul <stephane.bidoul@acsone.eu>
 * Arnaud Pineux <arnaud.pineux@acsone.eu>
 * Camille Morand <camille.morand@camptocamp.com>
+* `Trobz <https://trobz.com>`_:
+    * Dzung Tran <dungtd@trobz.com>
```

## odoo/addons/mis_builder_total_committed_purchase/static/description/index.html

### odoo/addons/mis_builder_total_committed_purchase/static/description/index.html

```diff
@@ -367,21 +367,21 @@
       <p>
         <a class="reference external" href="https://odoo-community.org/page/development-status">
           <img alt="Beta" src="https://img.shields.io/badge/maturity-Beta-yellow.png"/>
         </a>
         <a class="reference external" href="http://www.gnu.org/licenses/agpl-3.0-standalone.html">
           <img alt="License: AGPL-3" src="https://img.shields.io/badge/licence-AGPL--3-blue.png"/>
         </a>
-        <a class="reference external" href="https://github.com/OCA/mis-builder-contrib/tree/15.0/mis_builder_total_committed_purchase">
+        <a class="reference external" href="https://github.com/OCA/mis-builder-contrib/tree/16.0/mis_builder_total_committed_purchase">
           <img alt="OCA/mis-builder-contrib" src="https://img.shields.io/badge/github-OCA%2Fmis--builder--contrib-lightgray.png?logo=github"/>
         </a>
-        <a class="reference external" href="https://translation.odoo-community.org/projects/mis-builder-contrib-15-0/mis-builder-contrib-15-0-mis_builder_total_committed_purchase">
+        <a class="reference external" href="https://translation.odoo-community.org/projects/mis-builder-contrib-16-0/mis-builder-contrib-16-0-mis_builder_total_committed_purchase">
           <img alt="Translate me on Weblate" src="https://img.shields.io/badge/weblate-Translate%20me-F47D42.png"/>
         </a>
-        <a class="reference external" href="https://runbot.odoo-community.org/runbot/277/15.0">
+        <a class="reference external" href="https://runbot.odoo-community.org/runbot/277/16.0">
           <img alt="Try me on Runbot" src="https://img.shields.io/badge/runbot-Try%20me-875A7B.png"/>
         </a>
       </p>
       <p>Addon to create a alternative source based on all purchase order lines with MIS Builder : all the purchase orders that are not in draft or cancelled state are taken into account.</p>
       <p>The account_id of the committed purchase bases itself on the product’s account_id if set</p>
       <ul class="simple">
         <li>
@@ -436,15 +436,18 @@
               <li>
                 <a class="reference internal" href="#authors" id="id10">Authors</a>
               </li>
               <li>
                 <a class="reference internal" href="#contributors" id="id11">Contributors</a>
               </li>
               <li>
-                <a class="reference internal" href="#maintainers" id="id12">Maintainers</a>
+                <a class="reference internal" href="#other-credits" id="id12">Other credits</a>
+              </li>
+              <li>
+                <a class="reference internal" href="#maintainers" id="id13">Maintainers</a>
               </li>
             </ul>
           </li>
         </ul>
       </div>
       <div class="section" id="usage">
         <h1>
@@ -502,15 +505,15 @@
         </h1>
         <p>
           Bugs are tracked on
           <a class="reference external" href="https://github.com/OCA/mis-builder-contrib/issues">GitHub Issues</a>
           .
 In case of trouble, please check there if your issue has already been reported.
 If you spotted it first, help us smashing it by providing a detailed and welcomed
-          <a class="reference external" href="https://github.com/OCA/mis-builder-contrib/issues/new?body=module:%20mis_builder_total_committed_purchase%0Aversion:%2015.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**">feedback</a>
+          <a class="reference external" href="https://github.com/OCA/mis-builder-contrib/issues/new?body=module:%20mis_builder_total_committed_purchase%0Aversion:%2016.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**">feedback</a>
           .
         </p>
         <p>Do not contact contributors directly about support or help with technical issues.</p>
       </div>
       <div class="section" id="credits">
         <h1>
           <a class="toc-backref" href="#id9">Credits</a>
@@ -540,30 +543,53 @@
               &gt;
             </li>
             <li>
               Camille Morand &lt;
               <a class="reference external" href="mailto:camille.morand@camptocamp.com">camille.morand@camptocamp.com</a>
               &gt;
             </li>
+            <li>
+              <dl class="first docutils">
+                <dt>
+                  <a class="reference external" href="https://trobz.com">Trobz</a>
+                  :
+                </dt>
+                <dd>
+                  <ul class="first last">
+                    <li>
+                      Dzung Tran &lt;
+                      <a class="reference external" href="mailto:dungtd@trobz.com">dungtd@trobz.com</a>
+                      &gt;
+                    </li>
+                  </ul>
+                </dd>
+              </dl>
+            </li>
           </ul>
         </div>
+        <div class="section" id="other-credits">
+          <h2>
+            <a class="toc-backref" href="#id12">Other credits</a>
+          </h2>
+          <p>The migration of this module from 15.0 to 16.0 was financially supported by Camptocamp</p>
+        </div>
         <div class="section" id="maintainers">
           <h2>
-            <a class="toc-backref" href="#id12">Maintainers</a>
+            <a class="toc-backref" href="#id13">Maintainers</a>
           </h2>
           <p>This module is maintained by the OCA.</p>
           <a class="reference external image-reference" href="https://odoo-community.org">
             <img alt="Odoo Community Association" src="https://odoo-community.org/logo.png"/>
           </a>
           <p>OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.</p>
           <p>
             This module is part of the
-            <a class="reference external" href="https://github.com/OCA/mis-builder-contrib/tree/15.0/mis_builder_total_committed_purchase">OCA/mis-builder-contrib</a>
+            <a class="reference external" href="https://github.com/OCA/mis-builder-contrib/tree/16.0/mis_builder_total_committed_purchase">OCA/mis-builder-contrib</a>
             project on GitHub.
           </p>
           <p>
             You are welcome to contribute. To learn how please visit
             <a class="reference external" href="https://odoo-community.org/page/Contribute">https://odoo-community.org/page/Contribute</a>
             .
           </p>
```

## odoo/addons/mis_builder_total_committed_purchase/views/mis_total_committed_purchase.xml

### odoo/addons/mis_builder_total_committed_purchase/views/mis_total_committed_purchase.xml

```diff
@@ -8,15 +8,14 @@
     <field name="arch" type="xml">
       <tree>
         <field name="date"/>
         <field name="name"/>
         <field name="purchase_order_id"/>
         <field name="account_id"/>
         <field name="analytic_account_id" groups="analytic.group_analytic_accounting"/>
-        <field name="analytic_tag_ids" widget="many2many_tags" groups="analytic.group_analytic_tags"/>
         <field name="product_id"/>
         <field name="debit"/>
         <field name="credit"/>
       </tree>
     </field>
   </record>
 </odoo>
```

## Comparing `odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase_tag_rel.sql` & `odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase_analytic_account_rel.sql`

 * *Files 12% similar despite different names*

```diff
@@ -1,17 +1,25 @@
-CREATE OR REPLACE VIEW mis_total_committed_purchase_tag_rel AS(
+CREATE OR REPLACE VIEW mis_total_committed_purchase_analytic_account_rel AS(
     SELECT
         po_mcp.id AS mis_total_committed_purchase_id,
-        po_rel.account_analytic_tag_id AS account_analytic_tag_id
-        FROM account_analytic_tag_purchase_order_line_rel AS po_rel
+        jsonb_object_keys(po_rel.analytic_distribution)::INTEGER
+            AS analytic_account_id
+
+    FROM purchase_order_line AS po_rel
         INNER JOIN mis_total_committed_purchase AS po_mcp ON
-            po_mcp.res_id = po_rel.purchase_order_line_id
-        WHERE CAST(po_mcp.res_model AS VARCHAR) = 'purchase.order.line'
+            po_mcp.res_id = po_rel.id
+
+    WHERE CAST(po_mcp.res_model AS VARCHAR) = 'purchase.order.line'
+
     UNION ALL
+
     SELECT
         inv_mcp.id AS mis_total_committed_purchase_id,
-        inv_rel.account_analytic_tag_id AS account_analytic_tag_id
-        FROM account_analytic_tag_account_move_line_rel AS inv_rel
+        jsonb_object_keys(inv_rel.analytic_distribution)::INTEGER
+            AS analytic_account_id
+
+    FROM account_move_line AS inv_rel
         INNER JOIN mis_total_committed_purchase AS inv_mcp ON
-            inv_mcp.res_id = inv_rel.account_move_line_id
-        WHERE CAST(inv_mcp.res_model AS VARCHAR) = 'account.move.line'
+            inv_mcp.res_id = inv_rel.id
+
+    WHERE CAST(inv_mcp.res_model AS VARCHAR) = 'account.move.line'
 )
```

## Comparing `odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/METADATA` & `odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/METADATA`

 * *Files 3% similar despite different names*

```diff
@@ -1,23 +1,23 @@
 Metadata-Version: 2.1
 Name: odoo-addon-mis-builder-total-committed-purchase
-Version: 15.0.1.0.1.3
+Version: 16.0.1.0.0.2
 Summary: Addon to create a alternative source based on all purchase order line with MIS Builder.
 Home-page: https://github.com/OCA/mis-builder-contrib
 Author: ACSONE SA/NV, Camptocamp, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
 Classifier: Framework :: Odoo
-Classifier: Framework :: Odoo :: 15.0
+Classifier: Framework :: Odoo :: 16.0
 Classifier: License :: OSI Approved :: GNU Affero General Public License v3
-Requires-Python: >=3.8
-Requires-Dist: odoo-addon-mis-builder (<15.1dev,>=15.0dev)
-Requires-Dist: odoo (<15.1dev,>=15.0a)
+Requires-Python: >=3.10
+Requires-Dist: odoo-addon-mis-builder (<16.1dev,>=16.0dev)
+Requires-Dist: odoo (<16.1dev,>=16.0a)
 
 ====================================
 MIS Builder Total Committed Purchase
 ====================================
 
 .. !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !! This file is generated by oca-gen-addon-readme !!
@@ -27,21 +27,21 @@
 .. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
     :target: https://odoo-community.org/page/development-status
     :alt: Beta
 .. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
     :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
     :alt: License: AGPL-3
 .. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fmis--builder--contrib-lightgray.png?logo=github
-    :target: https://github.com/OCA/mis-builder-contrib/tree/15.0/mis_builder_total_committed_purchase
+    :target: https://github.com/OCA/mis-builder-contrib/tree/16.0/mis_builder_total_committed_purchase
     :alt: OCA/mis-builder-contrib
 .. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
-    :target: https://translation.odoo-community.org/projects/mis-builder-contrib-15-0/mis-builder-contrib-15-0-mis_builder_total_committed_purchase
+    :target: https://translation.odoo-community.org/projects/mis-builder-contrib-16-0/mis-builder-contrib-16-0-mis_builder_total_committed_purchase
     :alt: Translate me on Weblate
 .. |badge5| image:: https://img.shields.io/badge/runbot-Try%20me-875A7B.png
-    :target: https://runbot.odoo-community.org/runbot/277/15.0
+    :target: https://runbot.odoo-community.org/runbot/277/16.0
     :alt: Try me on Runbot
 
 |badge1| |badge2| |badge3| |badge4| |badge5| 
 
 Addon to create a alternative source based on all purchase order lines with MIS Builder : all the purchase orders that are not in draft or cancelled state are taken into account.
 
 The account_id of the committed purchase bases itself on the product's account_id if set
@@ -95,15 +95,15 @@
 
 Bug Tracker
 ===========
 
 Bugs are tracked on `GitHub Issues <https://github.com/OCA/mis-builder-contrib/issues>`_.
 In case of trouble, please check there if your issue has already been reported.
 If you spotted it first, help us smashing it by providing a detailed and welcomed
-`feedback <https://github.com/OCA/mis-builder-contrib/issues/new?body=module:%20mis_builder_total_committed_purchase%0Aversion:%2015.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.
+`feedback <https://github.com/OCA/mis-builder-contrib/issues/new?body=module:%20mis_builder_total_committed_purchase%0Aversion:%2016.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.
 
 Do not contact contributors directly about support or help with technical issues.
 
 Credits
 =======
 
 Authors
@@ -114,26 +114,33 @@
 
 Contributors
 ~~~~~~~~~~~~
 
 * Stéphane Bidoul <stephane.bidoul@acsone.eu>
 * Arnaud Pineux <arnaud.pineux@acsone.eu>
 * Camille Morand <camille.morand@camptocamp.com>
+* `Trobz <https://trobz.com>`_:
+    * Dzung Tran <dungtd@trobz.com>
+
+Other credits
+~~~~~~~~~~~~~
+
+The migration of this module from 15.0 to 16.0 was financially supported by Camptocamp
 
 Maintainers
 ~~~~~~~~~~~
 
 This module is maintained by the OCA.
 
 .. image:: https://odoo-community.org/logo.png
    :alt: Odoo Community Association
    :target: https://odoo-community.org
 
 OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.
 
-This module is part of the `OCA/mis-builder-contrib <https://github.com/OCA/mis-builder-contrib/tree/15.0/mis_builder_total_committed_purchase>`_ project on GitHub.
+This module is part of the `OCA/mis-builder-contrib <https://github.com/OCA/mis-builder-contrib/tree/16.0/mis_builder_total_committed_purchase>`_ project on GitHub.
 
 You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
```

## Comparing `odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/RECORD` & `odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/RECORD`

 * *Files 13% similar despite different names*

```diff
@@ -1,22 +1,23 @@
-odoo/addons/mis_builder_total_committed_purchase/README.rst,sha256=h_dBJyZCh3dKxryoDhYsZ3X4S5bEN0ZLD3baRrXU1dk,4426
+odoo/addons/mis_builder_total_committed_purchase/README.rst,sha256=1sGiyhqjmdJ0GiSUgqynkA296oZj8-hzA4yj_3wnCSo,4611
 odoo/addons/mis_builder_total_committed_purchase/__init__.py,sha256=oK14ywepisZ7PoVmiZSrgqiscgNvRr1JW9prlZgoXjA,202
-odoo/addons/mis_builder_total_committed_purchase/__manifest__.py,sha256=P7UJ_OHkpgxjrI8hHTqflsq_fq6huKDiDxPyGuWjMCk,820
-odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase.sql,sha256=2sGTJIekELJRe06t2Syz7gnrz1AxkqXi_ntkomzA_6I,4810
-odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase_tag_rel.sql,sha256=xW4Y5tDdXg38qpoESYm2stzevTYclxG6-tELxIt9Zfc,861
-odoo/addons/mis_builder_total_committed_purchase/i18n/mis_builder_total_committed_purchase.pot,sha256=JvXzLacHuQXB5IbW5MQQErqvmsr7-IqP9124vhz3Xfs,3221
+odoo/addons/mis_builder_total_committed_purchase/__manifest__.py,sha256=PK-zyXynB2v0T4-klk493Glpd9q7dLhg58mvqCl698g,833
+odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase.sql,sha256=lYQVDzxekXi7XlrqnV95AXlBxaMgOK3Xvbu9WG1WtOg,5601
+odoo/addons/mis_builder_total_committed_purchase/data/mis_total_committed_purchase_analytic_account_rel.sql,sha256=Pgz3KY1ncL2jqKKh_ad7UuvabIAqXrEaY1auwXW4ZGs,844
+odoo/addons/mis_builder_total_committed_purchase/i18n/mis_builder_total_committed_purchase.pot,sha256=dFUFukf-uHnqPQMr7Rtm_ZGE3nF5gatF_RKd5WMz63c,3007
 odoo/addons/mis_builder_total_committed_purchase/models/__init__.py,sha256=BvQNbhNnEzIxwOPqnIqcPPcHIxJO432LGi34L0uC53w,43
-odoo/addons/mis_builder_total_committed_purchase/models/mis_total_committed_purchase.py,sha256=-0BHV_fmJH91vLVoBKZn3kfIjArbW4Ly847OUfkbw3U,1990
-odoo/addons/mis_builder_total_committed_purchase/readme/CONTRIBUTORS.rst,sha256=Iv2uX8TqjbhJyQzYUwxGT3CABLVbjWK20n01Earh8Jw,138
+odoo/addons/mis_builder_total_committed_purchase/models/mis_total_committed_purchase.py,sha256=iM3iAhIrU-aGiVT7AFqkSqgc3iNGhnM6POyPVquhCEQ,1240
+odoo/addons/mis_builder_total_committed_purchase/readme/CONTRIBUTORS.rst,sha256=C6V2lNdn20Tk2OCLtWnUuIohtLbxCtmjbHw3-Oz3ru8,206
+odoo/addons/mis_builder_total_committed_purchase/readme/CREDITS.rst,sha256=XtPazYj6oqxvg62KjKqErJ8pssTcghFavMtYTDMOozc,87
 odoo/addons/mis_builder_total_committed_purchase/readme/DESCRIPTION.rst,sha256=nYWMHpV2QSBa6eC6B2AA7pWtJmxcS8Rsqzgu9OcCoq4,752
 odoo/addons/mis_builder_total_committed_purchase/readme/HISTORY.rst,sha256=tvuVDctaZufoMDuhwtziZzG2mpA9ZDeujTQFWI3q0so,377
 odoo/addons/mis_builder_total_committed_purchase/readme/ROADMAP.rst,sha256=QkeYqaOAR8Fi4So78AnlC3aliLm_DcW8syTLF6SvuBc,237
 odoo/addons/mis_builder_total_committed_purchase/readme/USAGE.rst,sha256=KjVeLQ5x8AK5kGyX7OusNbG4p1ZPrgVVJJxU8Qvd3ck,86
 odoo/addons/mis_builder_total_committed_purchase/readme/newsfragments/.gitignore,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 odoo/addons/mis_builder_total_committed_purchase/security/mis_total_committed_purchase.xml,sha256=X0SDEvQerP0Ycv3CCMhHMIPov-60z3FclAlH3AMZINE,649
 odoo/addons/mis_builder_total_committed_purchase/static/description/icon.png,sha256=0OCahdqDvaS_CHV97ZCbajW0_AcBLVVvja_EJA2mC6s,4770
-odoo/addons/mis_builder_total_committed_purchase/static/description/index.html,sha256=aOoFh7PRIrEAa1w6cK2G3VBnRsN881VHIMn5xTg0X54,14863
-odoo/addons/mis_builder_total_committed_purchase/views/mis_total_committed_purchase.xml,sha256=FbZ87C5wrNJoQPYmyR1f6g9ww6_2rU7mVX4xanNSpZk,1116
-odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/METADATA,sha256=UNKA6jecj0iW9wCwd1cxJUTD7c0LHFv0dyNvlcnDt3s,5128
-odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo_addon_mis_builder_total_committed_purchase-15.0.1.0.1.3.dist-info/RECORD,,
+odoo/addons/mis_builder_total_committed_purchase/static/description/index.html,sha256=XhvUxu0Qho50DqhW7EPhAPq0JHegGbPwsnqWTunDny4,15434
+odoo/addons/mis_builder_total_committed_purchase/views/mis_total_committed_purchase.xml,sha256=4E2jc27jtglAfh_0jDkJRnvNLRsxupkXwd5hyjNX-aU,928
+odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/METADATA,sha256=DgcXsdrlvuBJmFvwrGP2sVie5NqJN9qNmF_rzPcPS90,5314
+odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo_addon_mis_builder_total_committed_purchase-16.0.1.0.0.2.dist-info/RECORD,,
```

